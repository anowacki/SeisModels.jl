<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model types · SeisModels.jl documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SeisModels.jl documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../inbuilt_models/">Inbuilt models</a></li><li class="is-active"><a class="tocitem" href>Model types</a><ul class="internal"><li><a class="tocitem" href="#Type-hierarchy"><span>Type hierarchy</span></a></li><li><a class="tocitem" href="#Conversion"><span>Conversion</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../io/">Model input-output</a></li><li><a class="tocitem" href="../function_index/">Function index</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Model types</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model types</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/anowacki/SeisModels.jl/blob/master/docs/src/types.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-types"><a class="docs-heading-anchor" href="#Model-types">Model types</a><a id="Model-types-1"></a><a class="docs-heading-anchor-permalink" href="#Model-types" title="Permalink"></a></h1><h2 id="Type-hierarchy"><a class="docs-heading-anchor" href="#Type-hierarchy">Type hierarchy</a><a id="Type-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Type-hierarchy" title="Permalink"></a></h2><p>The module defines the SeisModel type and subtypes of this specify the kind of model (i.e., symmetry, nature of basis function, etc.).</p><p>The current type hierarchy is as follows:</p><ul><li><code>SeisModel</code>: Abstract type of all seismic models<ul><li><code>SeisModel1D</code>: Abstract type of all one-dimensonal (radially-symmetric) seismic models<ul><li><code>SteppedLayeredModel</code>: Type defined by layers with contstant properties.</li><li><code>LinearLayeredModel</code>: Type defined by layers with constant gradient.</li><li><code>PREMPolyModel</code>: Type defined by polynomials.</li></ul></li></ul></li></ul><p>As you can see, there are currently three types of models implemented, all 1D models, with polynomial, linear or constant basis within each layer.</p><h3 id="SteppedLayeredModel"><a class="docs-heading-anchor" href="#SteppedLayeredModel"><code>SteppedLayeredModel</code></a><a id="SteppedLayeredModel-1"></a><a class="docs-heading-anchor-permalink" href="#SteppedLayeredModel" title="Permalink"></a></h3><p>A <code>SteppedLayeredModel</code> is composed of a series of layers with constant properties in each layer.  The radii define the top of each layer.</p><p>An example of this is Weber et al.’s (2011) moon model:</p>/home/runner/work/SeisModels.jl/SeisModels.jl/docs/build/SteppedLayeredModel_example.svg<p><img src="../SteppedLayeredModel_example.svg" alt="Example of a SteppedLayeredModel"/></p><article class="docstring"><header><a class="docstring-binding" id="SeisModels.SteppedLayeredModel" href="#SeisModels.SteppedLayeredModel"><code>SeisModels.SteppedLayeredModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SteppedLayeredModel &lt;: SeisModel1D</code></pre><p>A <code>SteppedLayeredModel</code> contains <code>n</code> layers each with constant properties.</p></div></section></article><p>See the <a href="../function_index/#SeisModels.SteppedLayeredModel-Tuple{}">constructor</a> for details on creating <code>SteppedLayeredModel</code>s.</p><h3 id="LinearLayeredModel"><a class="docs-heading-anchor" href="#LinearLayeredModel"><code>LinearLayeredModel</code></a><a id="LinearLayeredModel-1"></a><a class="docs-heading-anchor-permalink" href="#LinearLayeredModel" title="Permalink"></a></h3><p>A <code>LinearLayeredModel</code> is described by radial nodes, between which the properties vary linearly.  Discontinutities are added by setting two subsequent nodes to have the same radii but different properties.</p><p>For example, a two-layer model for a planetesimal with radius 1 km and a liquid core at 0.3 km, with linearly varying properties, could be given by:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using SeisModels</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; m = LinearLayeredModel(r=[0, 0.3, 0.3, 1], vp=[1, 1, 1.8, 1], vs=[0, 0, 1, 0.7])</code><code class="nohighlight hljs ansi" style="display:block;">LinearLayeredModel(1.0, 4, [0.0, 0.3, 0.3, 1.0], [1.0, 1.0, 1.8, 1.0], [0.0, 0.0, 1.0, 0.7], Float64[], false, Float64[], Float64[], Float64[], Float64[], Float64[], false, Float64[], Float64[])</code></pre><p>You can see that the nodes are used to define a constant lower layer and linearly-varying upper layer:</p><p><img src="../LinearLayeredModel_example.svg" alt="Example of a LinearLayeredModel"/></p><p>Use <a href="../function_index/#SeisModels.discontinuities"><code>discontinuities</code></a> to find the radii and layer indices of the discontinuities in a <code>LinearLayeredModel</code>.</p><article class="docstring"><header><a class="docstring-binding" id="SeisModels.LinearLayeredModel" href="#SeisModels.LinearLayeredModel"><code>SeisModels.LinearLayeredModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinearLayeredModel &lt;: SeisModel1D</code></pre><p>A <code>LinearLayeredModel</code> contains <code>n</code> points at which velocities are defined, with linear interpolation between them.  Hence there are <code>n - 1</code> layers.</p><p>Discontinuities are represented by two layers with the same radii.</p><p>Use <a href="../function_index/#SeisModels.discontinuities"><code>discontinuities</code></a> to find the radii and layer indices of the discontinuities in a <code>LinearLayeredModel</code>.</p></div></section></article><p>See the <a href="../function_index/#SeisModels.LinearLayeredModel-Tuple{}">constructor</a> for details on creating <code>LinearLayeredModel</code>s.</p><h3 id="PREMPolyModel"><a class="docs-heading-anchor" href="#PREMPolyModel"><code>PREMPolyModel</code></a><a id="PREMPolyModel-1"></a><a class="docs-heading-anchor-permalink" href="#PREMPolyModel" title="Permalink"></a></h3><p><code>PREMPolyModel</code>s are parameterised (like PREM) by polynomials in each layer, considering the normalised radius <span>$x=r/a$</span>, where <span>$a$</span> is the surface radius. Clearly, <code>SteppedLayeredModel</code>s and <code>LinearLayeredModel</code>s are specific cases of a polynomial parameterisation.</p><p>For example, PREM’s outer core density in g/cm³ is given by <span>$12.5815 - 1.2638x - 3.6426x^2 - 5.5281x^3\,.$</span></p><p>One could imagine a single-layer planet whose velocities are described by</p><p class="math-container">\[V_\mathrm{P}(x) = 3 - 2x^2 - x^3\,,\]</p><p>where <span>$V_\mathrm{S} = V_\mathrm{P}/\alpha$</span>, and <span>$\alpha = 1.7$</span>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; radii = [500]    # Layer tops in km</code><code class="nohighlight hljs ansi" style="display:block;">1-element Vector{Int64}:
 500</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; vps =   reshape( # Ensure we have a matrix with 1 column and 4 rows
               [3       # x^0 coefficients in km/s
                0       # x^1
               -2       # x^2
               -1],     # x^3
                :, 1)</code><code class="nohighlight hljs ansi" style="display:block;">4×1 Matrix{Int64}:
  3
  0
 -2
 -1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; α = 1.7</code><code class="nohighlight hljs ansi" style="display:block;">1.7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; vss = vps./α</code><code class="nohighlight hljs ansi" style="display:block;">4×1 Matrix{Float64}:
  1.7647058823529411
  0.0
 -1.1764705882352942
 -0.5882352941176471</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; m = PREMPolyModel(r=radii, vp=vps, vs=vss)</code><code class="nohighlight hljs ansi" style="display:block;">PREMPolyModel(500.0, 1, [500.0], [3.0; 0.0; -2.0; -1.0;;], [1.7647058823529411; 0.0; -1.1764705882352942; -0.5882352941176471;;], Matrix{Float64}(undef, 0, 0), false, Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), false, Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), NaN)</code></pre><p>Note that the polynomial coefficients appear as the row of a matrix, and each layer occupies a column.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Plots: plot, plot!, vline!, savefig</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p = plot(xlabel=&quot;Radius (km)&quot;, ylabel=&quot;Velocity (km/s) or Density (g/cm^3)&quot;, title=&quot;PREMPolyModel example&quot;, framestyle=:box, grid=false)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=0}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for (f, name) in zip((vp, vs), (&quot;Vp&quot;, &quot;Vs&quot;))
           plot!(p, r-&gt;f(m, r), 0, surface_radius(m), label=name)
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; vline!(p, m.r, line=(0.5,:dash), label=&quot;Layer tops&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;PREMPolyModel_example.svg&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;/home/runner/work/SeisModels.jl/SeisModels.jl/docs/build/PREMPolyModel_example.svg&quot;</code></pre><p><img src="../PREMPolyModel_example.svg" alt="Example of a PREMPolyModel"/></p><article class="docstring"><header><a class="docstring-binding" id="SeisModels.PREMPolyModel" href="#SeisModels.PREMPolyModel"><code>SeisModels.PREMPolyModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PREMPolyModel &lt;: SeisModel1D</code></pre><p>Type describing the Earth as a set of layers within which properties vary according to a set of polynomials.</p><p>Physical parameters are represented by arrays of size <code>(order+1, n)</code>, where <code>n</code> is the number of layers, and <code>order</code> is the order of polynomial which is used to represent the parameter.  Hence a constant layer has size <code>(1,n)</code>, and to compute the value of <code>x</code> in layer <code>i</code>, for an Earth radius of <code>a</code> km, at a radius of <code>r</code> km, the expression is:</p><pre><code class="nohighlight hljs">val_x = x[i,1] + (r/a)*x[i,2] + (r/a)^2*x[i,3] ... (r/a)^order*x[i,order+1]</code></pre><p>The reference frequency in Hz for the velocities in case of attenuation is given by the <code>fref</code> field.  If <code>fref</code> is <code>NaN</code>, then no reference frequency is defined for the model.</p></div></section></article><p>See the <a href="../function_index/#SeisModels.PREMPolyModel-Tuple{}">constructor</a> for details on creating <code>PREMPolyModel</code>s.</p><h4 id="Attenuation"><a class="docs-heading-anchor" href="#Attenuation">Attenuation</a><a id="Attenuation-1"></a><a class="docs-heading-anchor-permalink" href="#Attenuation" title="Permalink"></a></h4><p>Attenuation in <code>PREMPolyModels</code> is specified as in PREM (see equation (3) in section 6 on page 309).  That means, the shear and bulk quality factors (<span>$Q_\mu$</span> and <span>$Q_\kappa$</span> respectively) control the effective velocities, which will vary by wave frequency.</p><p>By default, velocities for <code>PREMPolyModel</code>s are returned at the reference frequency, which can be found with <a href="../function_index/#SeisModels.reffrequency"><code>reffrequency</code></a> and is given in Hz.  To obtain velocities at other frequencies, just pass a target frequency to the relevant function via the <code>freq</code> keyword argument.</p><p>In this example, we ask for the Voigt average isotropic shear-wave velocity at radius 4500 km for a frequency of 0.01 Hz (equally, 100 s period):</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; vs(PREM, 4500, freq=0.01)</code><code class="nohighlight hljs ansi" style="display:block;">6.840542771852348</code></pre><h2 id="Conversion"><a class="docs-heading-anchor" href="#Conversion">Conversion</a><a id="Conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Conversion" title="Permalink"></a></h2><p>Conversion can be performed between any of the above model types.  Note that in some cases (e.g., <code>SteppedLayeredModel</code> to <code>LinearLayeredModel</code> or <code>LinearLayeredModel</code> to <code>PREMPolyModel</code>) no information is lost, whilst in others (e.g., <code>PREMPolyModel</code> to <code>LinearLayeredModel</code> or to <code>SteppedLayeredModel</code>) the converted model can only be an approximation to the original.</p><p>To convert between model types, simply pass one model to the constructor of another.  For example:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; m = PREM;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; m2 = LinearLayeredModel(PREM);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; typeof(m2)</code><code class="nohighlight hljs ansi" style="display:block;">LinearLayeredModel</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ≈(mass(m), mass(m2))</code><code class="nohighlight hljs ansi" style="display:block;">false</code></pre><p>See the <a href="../function_index/#conversion">conversion section</a> for details.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inbuilt_models/">« Inbuilt models</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 25 October 2023 14:46">Wednesday 25 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
